import time
import re
import traceback
import multiprocessing
import os
import json


def read_csv(sparkSession, input_file):
    return sparkSession.read.csv(input_file, sep=',', inferSchema=True)


def read_file(config_path):
    with open(config_path, 'r') as file:
        return json.load(file)


def write_file(config_path, metadata):
    with open(config_path, 'w') as file:
        file.write(json.dumps(metadata))


def convertcsv_toparquet(df, output_folder):
    df = df.toDF(*(c.replace('_c', 'column') for c in df.columns))
    df.write.option("header", "true").mode("overwrite").parquet(output_folder)


def print_exception(function_name):
    print(f'Exception in function name - {function_name}')
    traceback.print_exc()


def create_dummy_file(sample_data, rows=100000, output_file='stress_test_data.txt'):
    # 10 gb creation - 20 seconds for rec in range(0,500000)
    # 18 gb creation - 43 seconds for rec in range(0,900000)
    try:
        print('---------- Start: create_dummy_file ----------------')
        # argument validation
        if sample_data == '':
            print('Empty input data passed, nothing to do - Exit')

        start_time = time.time()

        #sample_data = "1012001'~'CEC2017KOSU0053'~'2018-01-13 00:00:00'~'W.P.TRADING CORP'~''~'350 5th Avenue'~'New York'~'New York'~'10118'~'United States'~'44425805'~'KING OCEAN AGENCY INC.'~'Parque Industrial Machangara, Panamericana Norte km 4, Cuenca, Azuay, Ecuador'~''~'Cuenca'~'Azuay'~''~'Ecuador'~'33499873'~'GRAIMAN CIA. LTDA.'~'0190122271001'~''~'A Customs Brokerage, Inc.'~'GUAYAQUIL'~'PORT EVERGLADES'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'PLANET V'~'Antigua And Barbuda'~'AG'~'PORCELANA'~'31'~'PAQUETES'~'26770'~'STC GLAZED PORCELAIN'~'1'~'0'~''~'KING OCEAN ECUADOR KINGOCEAN S.A.'~'2018-03-20 00:00:00#@#@#1012011'~'CEC2017KOSU0053'~'2018-01-13 00:00:00'~'TRADEPRO INC'~'UNITED STATES OF AMERICA'~''~''~''~''~'United States'~'27842938'~'KING OCEAN AGENCY INC.'~'AV. PATRIA Y AMAZONAS EDIF. COFIEC 6TO. PISO QUITO, PICHINCHA'~'Avenida Patria'~'Quito Canton'~'Pichincha'~''~'Ecuador'~'28822114'~'PRODUCTOS PARAISO DEL ECUADOR S.A.'~'1790098230001'~''~'Kuehne & Nagel, Inc.'~'GUAYAQUIL'~'PORT EVERGLADES'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'PLANET V'~'Antigua And Barbuda'~'AG'~'SACOS DE POLIETILENO'~'6796'~'PAQUETES'~'49151'~'STC BAGS OF HIGH DENSITY POLIETHYLENE'~'0'~'2'~''~'KING OCEAN ECUADOR KINGOCEAN S.A.'~'2018-03-20 00:00:00#@#@#1012021'~'CEC2017KOSU0053'~'2018-01-13 00:00:00'~'ECORIPE TROPICALS'~''~''~''~''~''~'United States'~'27870796'~'KING OCEAN AGENCY INC.'~'ECGYE'~''~''~'Manabi'~''~'Ecuador'~'39999095'~'OCAMPO IZA EDISSON ALEJANDRO'~'1308821931001'~''~'CUSTOMIZED BROKERS INC.,'~'GUAYAQUIL'~'PORT EVERGLADES'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'PLANET V'~'Antigua And Barbuda'~'AG'~'PLATANO'~'1379'~'PAQUETES'~'24285.7'~'STC PLANTAINSDASHEENEDDOE'~'0'~'1'~''~'KING OCEAN ECUADOR KINGOCEAN S.A.'~'2018-03-20 00:00:00#@#@#1012031'~'CEC2018SUDU0002'~'2018-01-10 00:00:00'~'LEVE INTERNATIONAL TRADING'~''~''~''~''~''~'Netherlands'~'38698569'~'HAMBURG SUD'~'GUAYAS'~'Los Naranjos'~'Guayaquil'~'Guayas'~'090615'~'Ecuador'~'33469414'~'EXOFRUT S.A.'~'0990209898001'~'SUDU - Hamburg Sued'~'LEVE INTERNATIONAL TRADING'~'GUAYAQUIL'~'ROTTERDAM'~'Netherlands'~'NETHERLANDS'~'Rotterdam (NL)'~'Netherlands'~'NLRTM'~''~''~''~'MINERVA'~'Singapore'~'SG'~'PULPA DE FRUTA'~'910'~'CAJAS'~'7943'~'FRUIT PULPE SAID TO CONTAIN FRUIT PULPS IN 910 BOXES AS FOLLOWS MORABERRY PULP  130 BOXES GUAVA PULP  260 BOXES TAMARIND PULP  130 BOXES GUANABANA PULP  390 BOXES TOTAL NET 5460 KG  7943 KG GROSS DAE 02820184000019180 HS 081190 TEMPERATURE   18C'~'1'~'0'~''~'HAMBURG SÜD ECUADOR S.A.'~'2018-03-20 00:00:00#@#@#1012041'~'CEC2018SUDU0002'~'2018-01-10 00:00:00'~'GREEN FOREST PRODUCTS, LLC/105N. AP'~''~''~''~''~''~'United States'~'44313508'~'HAMBURG SUD'~'GUAYAQUIL'~''~'Guayas'~'Guayas'~''~'Ecuador'~'28499986'~'ENCHAPES DECORATIVOS S.A. ENDESA'~'1790175952001'~'SUDU - Hamburg Sued'~'GREEN FOREST PRODUCTS, LLC/105N. AP'~'GUAYAQUIL'~'BALTIMORE'~'United States'~'UNITED STATES OF AMERICA'~'Baltimore (US)'~'United States'~'USBAL'~''~''~''~'MINERVA'~'Singapore'~'SG'~'MADERA DE BALSA'~'32'~'PAQUETES'~'39166.37'~'BALSA WOOD 16 BUNDLES 2480 TR HARDWOOD PLYWOOD BC 1220X2440X520 MM 3839 M3 1917437 KB 16 BUNDLES 16 BUNDLES 1120 TR HARDWOOD PLYWOOD BC 1220X2440X1200 MM 4001 M3 1999200 KB 2X40 HC CONTAINER STC PLYWOOD IS NOT SURFACE COATED AND EACH PLY IS MADE OF TROPIC'~'0'~'2'~''~'HAMBURG SÜD ECUADOR S.A.'~'2018-03-20 00:00:00#@#@#1012051'~'CEC2018SUDU0002'~'2018-01-10 00:00:00'~'PRIME SEAFOOD IMPORTS, INC.'~''~''~''~''~''~'United States'~'35936305'~'HAMBURG SUD'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'38581973'~'SOCIEDAD NACIONAL DE GALAPAGOS C.A.'~'0990033110001'~'SUDU - Hamburg Sued'~'COPPERSMITH GLOBAL LOGISTICS'~'GUAYAQUIL'~'HOUSTON'~'United States'~'UNITED STATES OF AMERICA'~'Arlington, Houston (US)'~'United States'~'USAGW'~''~''~''~'MINERVA'~'Singapore'~'SG'~'CAMARON CONGELADO'~'1134'~'CARTON'~'22932.89'~'1134 TOTAL CARTONS 1134 TOTAL CARTONS HEADON SHELLON RAW FROZEN LITOPENAEUS VANNAMEI SHRIMPS SEMIIQF PACKING 10X4LB BRAND CHAMPMAR REF T 00022018 POHT121917 NW 2057516 KGS THERMOGRAPH 77294389 DAE 02820184000016845 HS CODE 030617 FREIGHT COLLECT TEMP 18 C'~'0'~'1'~''~'HAMBURG SÜD ECUADOR S.A.'~'2018-03-20 00:00:00#@#@#1012061'~'CEC2018SUDU0002'~'2018-01-10 00:00:00'~'GURIT BALSA S.L'~''~''~''~''~''~''~''~'HAMBURG SUD'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'36832323'~'GURITBALSAFLEX CIA. LTDA'~'0992500670001'~'SUDU - Hamburg Sued'~'Revchem Composites, Inc.'~'GUAYAQUIL'~'OAKLAND'~'United States'~'UNITED STATES OF AMERICA'~'Oak Park, Oakland (US)'~'United States'~'USOPC'~''~''~''~'MINERVA'~'Singapore'~'SG'~'MADERA DE BALSA'~'238'~'CAJA (≪BOX≫)'~'10170'~'1X40HC STC 238 BOXES INDUSTRIALIZED BALSA DAE 02820184000015587'~'0'~'1'~''~'HAMBURG SÜD ECUADOR S.A.'~'2018-03-20 00:00:00#@#@#1011701'~'CEC2017MARC0216'~'2018-01-08 00:00:00'~'OOO EMIS'~''~''~''~''~''~''~''~'STAR REEFER'~'ECGYE'~''~''~''~''~'Ecuador'~'40019618'~'GREEN EXPRESS S.A. GREEN EXPRESA'~'0992716452001'~'SREE - Star Reefers Uk Ltd'~'MKM LTD'~'GUAYAQUIL'~'SAINT PETERSBURG (EX LENINGRAD)'~'Russia'~'RUSSIA'~''~''~''~''~''~''~'ANDALUCIA STAR'~'Bahamas'~'BS'~'BANANO'~'4840'~'CAJAS'~'100672'~'04 X 40  RF  CONTAINERS STC: BOXES OF FRESH BANANAS GREEN CAVENDISH FIRST CLASS ECUADORIAN TYPE 22XU OF 19,40 NET WEIGHT 20.80 GROSS WEIGHT HS CODE: 0803901190'~'0'~'4'~''~'MARITIMA ECUATORIANA MARSEC S.A.'~'2018-03-20 00:00:00#@#@#1011711'~'CEC2017MARC0216'~'2018-01-08 00:00:00'~'GREENFRUIT LLC'~''~''~''~''~''~'Russia'~'41727241'~'STAR REEFER'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'28462133'~'ECUAGREENPRODEX S.A.'~'0992677783001'~'SREE - Star Reefers Uk Ltd'~'MKM LTD'~'GUAYAQUIL'~'SAINT PETERSBURG (EX LENINGRAD)'~'Russia'~'RUSSIA'~''~''~''~''~''~''~'ANDALUCIA STAR'~'Bahamas'~'BS'~'BANANO'~'2420'~'CAJAS'~'50336'~'02 X 40  RF  CONTAINERS STC:  BOXES OF FRESH BANANAS GREEN CAVENDISH FIRST CLASS ECUADORIAN TYPE 22XU OF 20,80 GROSS WEIGHT AND 19,40 NET WEIGHT HS CODE: 0803901190'~'0'~'2'~''~'MARITIMA ECUATORIANA MARSEC S.A.'~'2018-03-20 00:00:00#@#@#1011721'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'CERAMICA DEL PACIFICO S.A. DE C.V.'~''~''~''~''~''~''~''~'MAERSK LINE'~'AZUAY'~''~''~'Azuay'~''~'Ecuador'~'45996447'~'CERAMICA RIALTO S.A.'~'0190062317001'~'MAEU - Maersk Line'~'CERAMICA DEL PACIFICO S.A. DE C.V.'~'GUAYAQUIL'~'ACAJUTLA'~'El Salvador'~'EL SALVADOR'~'Acajutla (SV)'~'El Salvador'~'SVAQJ'~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'CERAMICA'~'835'~'CAJA (≪BOX≫)'~'26748.36'~'835 CAJAS EN 18 PALLETS CON CERAMICA    FACTURA No 0010030001746   DAE 02820184000023020   P.A 6907.23.00.90   TOTAL CAJAS PRODUCTO 835   TOTAL PALLETS PRODUCTO 18   PESO NETO TOTAL        26.148,53  KGS   PESO BRUTO TOTAL       26.478,36  KGS'~'1'~'0'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011731'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'MAYOREO ABONOS AGRO S.A'~'GRAVILIAS DESAMPARADOS SAN JOSE'~''~'San Jose'~'San Jose'~''~'Costa Rica'~'33995177'~'MAERSK LINE'~'AZUAY'~''~''~'Azuay'~''~'Ecuador'~'45996447'~'CERAMICA RIALTO S.A.'~'0190062317001'~'MAEU - Maersk Line'~'MAYOREO ABONOS AGRO S.A'~'GUAYAQUIL'~'SAN JOSE'~'Costa Rica'~'COSTA RICA'~'Caldera (CR)'~'Costa Rica'~'CRCAL'~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'CERAMICA'~'2892'~'CAJA (≪BOX≫)'~'79155.22'~'800 CAJAS EN 20 PALLETS CON CERAMICA   NW  26.035,20  KGS   GW  26.179,20  KGS'~'3'~'0'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011741'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'Liberty Seafood'~''~''~'Perth Amboy'~'New Jersey'~''~'United States'~'34069035'~'MAERSK LINE'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'40019811'~'INDUSTRIAL PESQUERA SANTA PRISCILA S.A.'~'0991257721001'~'MAEU - Maersk Line'~'New York Customs Brokers Inc.'~'GUAYAQUIL'~'STATEN ISLAND'~'United States'~'UNITED STATES OF AMERICA'~'Staten Island (US)'~'United States'~'USUYU'~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'CAMARON CONGELADO'~'1000'~'CAJA (≪BOX≫)'~'20865.6'~'FROZEN WHITE SHRIMP CAMARONES BLANCOS ENTEROS CONGELADOS ACUERDOAGREEMENT 24 SHIPMENT 0020925 FACT 001007000008057 DAE 02820184000021405 P.O  20928 18.144,00 NET WEIGHT 20.865,60 GROSS WEIGHT 40.000,00 NET POUNDS 46.000,00 GROSS POUNDS FREIGHT PREPAID TEM'~'0'~'1'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011751'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'ELEKTRA NORESTE, S.A. (ENSA)'~'TORRE OESTE BUSINESS PARK COSTA DEL ESTE, PISO 3 PANAMA CITY 0833-00202'~''~'Panama'~'Panama'~''~'Panama'~'28787916'~'MAERSK LINE'~'AMBATO'~''~''~'Tungurahua'~''~'Ecuador'~'28793634'~'ECUATRAN SA'~'1890061385001'~'MAEU - Maersk Line'~'ELEKTRA NORESTE, S.A. (ENSA)'~'GUAYAQUIL'~'BALBOA'~'Panama'~'PANAMA'~'Balboa (US)'~'United States'~'USBAZ'~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'TRANSFORMADORES'~'23'~'CAJAS'~'13049'~'1X40 HC CONTAINER STC23 BULKSTRANSFORMADOR MONOFASICO SUBESTACIONDE 75 KVA 7620/13200Y (2B) 120/240 (3B)TRANSFORMADOR TRIFASICO PADMOUNTEDDE 150 KVA 13200V 280VPARTIDA ARANCELARIA: TRANSF. 8504.21.90.00DAE: 028-2018-40-00023422FREIGHT PREPAIDEXPRESS RELEA'~'0'~'1'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011761'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'MAXFIELD GROUP, INC.'~''~''~''~''~''~'United States'~'33596410'~'MAERSK LINE'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'40019811'~'INDUSTRIAL PESQUERA SANTA PRISCILA S.A.'~'0991257721001'~'MAEU - Maersk Line'~'MAXFIELD GROUP, INC.'~'GUAYAQUIL'~'LOS ANGELES'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'CAMARON CONGELADO'~'900'~'CAJA (≪BOX≫)'~'18779.04'~'FROZEN SHRIMPS  FARM RAISED THIS PRODUCT IS RAW CAMARONES BLANCOS COLA CONGELADOS SHIPMENT No. 0020967 FACT 001007000008099 DAE 02820184000014555 CODE 03.06.17 16.329,60 NET WEIGHT 18.779,04 GROSS WEIGHT 36.000,00 NET POUNDS 41.400,00 GROSS POUNDS NATURAL'~'0'~'1'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011771'~'CEC2018MAEU0016'~'2018-01-13 00:00:00'~'CHIQUITA EUROPE B.V.'~''~''~''~''~''~''~''~'GREAT WHITE FLEET'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'41610327'~'CHIQUITA BANANA ECUADOR CBBRANDS S.A.'~'0991237313001'~'GWFL - Great White Fleet Ltd'~'NURMINEN LOGISTICS SERVICES OY'~'GUAYAQUIL'~'WILMINGTON'~'United States'~'UNITED STATES OF AMERICA'~'New Wilmington (US)'~'United States'~'USNEU'~''~''~''~'SEALAND BALBOA'~'Portugal'~'PT'~'BANANO'~'1080'~'CAJA (≪BOX≫)'~'21682.08'~'FRESH GREEN ORGANIC BANANAS'~'0'~'0'~''~'REMAR REPRESENTACIONES MARITIMAS DEL ECUADOR SA REMAR'~'2018-03-20 00:00:00#@#@#1011781'~'CEC2018MAEU0030'~'2018-01-12 00:00:00'~'PRODUCTORA OCCIDENTAL PORCINA, C.A.'~''~''~''~''~''~''~''~'MAERSK LINE'~'AV LEOPOLDO BENITEZ SN AV JOAQUIN ORANTIA GUAYAQUIL EC'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'38641127'~'FEEDPRO S.A.'~'0992517182001'~'MAEU - Maersk Line'~'PRODUCTORA OCCIDENTAL PORCINA, C.A.'~'GUAYAQUIL'~'MARACAIBO'~'Venezuela'~'VENEZUELA'~'Bachaquero/Maracaibo L (VE)'~'Venezuela'~'VEBAV'~''~''~''~'MAERSK WAKAYAMA'~'Panama'~'PA'~'HARINA DE PESCADO'~'800'~'CAJA (≪BOX≫)'~'40000'~'OF ECUADORIAN FISHMEAL (HARINA DE PESCADO) NET WEIGHT 40,000.00KG DAE 0282018400001755 PA 230120'~'2'~'0'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011791'~'CEC2018MAEU0030'~'2018-01-12 00:00:00'~'NESTLE MEXICO, S.A. DE C.V.'~'EJERCITO NACIONAL/453//GRANADA/MIGUEL HGO DF/L CONSTANZA Y ESTEFANIA TLAHUAC DISTRITO FEDERAL 11520'~''~''~''~''~'Mexico'~'28409493'~'MAERSK LINE'~'QUITO'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'28795759'~'NESTLE ECUADOR S.A.'~'0990032246001'~'MAEU - Maersk Line'~'APL LOGISTICS WAREHOUSE MANAGMENT'~'GUAYAQUIL'~'VERACRUZ'~'Mexico'~'MEXICO'~'Veracruz (MX)'~'Mexico'~'MXVER'~''~''~''~'MAERSK WAKAYAMA'~'Panama'~'PA'~'CACAO'~'668'~'CAJA (≪BOX≫)'~'46426'~'Cacao CCN51 N8255100 PO 8700347041 DAE 02820184000005200 TOTAL PESO NETO 46.092,00 KGN TOTAL PESO BRUTO 46.426,00 KGB PA 1806.31.00'~'0'~'2'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011801'~'CEC2018MAEU0030'~'2018-01-12 00:00:00'~'VLM FOODS USA LTD.'~''~''~''~''~''~'United States'~'45691283'~'MAERSK LINE'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'40020006'~'PROVEFRUT S.A.'~'1790971937001'~'MAEU - Maersk Line'~'J.E.S. Forwarding Inc.'~'GUAYAQUIL'~'STATEN ISLAND'~'United States'~'UNITED STATES OF AMERICA'~'Staten Island (US)'~'United States'~'USUYU'~''~''~''~'MAERSK WAKAYAMA'~'Panama'~'PA'~'BROCOLI'~'1013'~'CAJA (≪BOX≫)'~'16167.11'~'1012 BXS. IQF ORGANIC BROCCOLI FLORETS  01 BULK WITH 20 EMPTY BOXES CALL OFF PO 98865 NET WEIGHT 14710.21 KGS  32430.12 LBS  GROSS WEIGHT 16167.11 KGS  35642.00 LBS  DAE. 02820174000884914 HS CODE 0710.80.20.00'~'0'~'1'~''~'MAERSK DEL ECUADOR C.A.'~'2018-03-20 00:00:00#@#@#1011811'~'CEC2018SUDU0003'~'2018-01-12 00:00:00'~'VICTOR HUGO ROJAS ISLA COMERCIALIZADORA Y DISTRIBUIDORA E.I.R.L'~''~''~''~''~''~'Chile'~'41542552'~'HAMBURG SUD'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'45367973'~'INSUPLAT S A'~'1391849753001'~'SUDU - Hamburg Sued'~'VICTOR HUGO ROJAS ISLA COMERCIALIZADORA Y DISTRIBUIDORA E.I.R.L'~'GUAYAQUIL'~'SAN ANTONIO'~'Chile'~'CHILE'~''~''~''~''~''~''~'JPO LIBRA'~'Liberia'~'LR'~'PLATANO'~'1080'~'CAJA (≪BOX≫)'~'25920'~'1X40 RH CNTR S.T.C. 1080 TOTAL BOXES  FRESH PLANTAINS BRAND: INSUPLAT     TOTAL NET WEIGHT:       24494,40 KG  TOTAL GROSS WEIGHT:  25920,00 KG  HS CODE:# 0803101000  DAE #  028-2018-40-00016878 TEMP: 7.5 C'~'0'~'1'~''~'HAMBURG SÜD ECUADOR S.A.'~'2018-03-20 00:00:00#@#@#1011821'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'KOAM TRADE CORP'~''~''~''~''~''~'United States'~'33459899'~'SEABOARD MARINE'~'GUAYAS'~''~''~''~''~'Ecuador'~'36524502'~'VECONSA S.A.'~'0991311602001'~'SMLU - Seaboard Marine Ltd'~'STEVE S AHN CUSTOM HOUSE BROKER'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'ARVEJAS'~'1800'~'PAQUETES'~'22140'~'GREEN PIGEON PEAS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011831'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EXP GROUP LLC'~''~''~''~''~''~'United States'~'38572811'~'SEABOARD MARINE'~'GUAYAS'~''~'Guayas'~'Guayas'~''~'Ecuador'~'45994444'~'TROPICALFRUIT EXPORT S.A.'~'0992451467001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1080'~'PAQUETES'~'25920'~'PLANTAINS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011841'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EXP GROUP LLC'~''~''~''~''~''~'United States'~'38572811'~'SEABOARD MARINE'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'37852821'~'EXCHANGECORP S.A.'~'0992736844001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1080'~'PAQUETES'~'25920'~'PLANTAINS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011851'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'CHIQUITA FRESH NORTH AMERICA LLC'~'30 AV AND HIGHWAY 90 GULFPORT MS 39501'~''~''~''~''~'United States'~'27824297'~'SEABOARD MARINE'~'GUAYAQUIL'~''~'Guayaquil'~'Guayas'~''~'Ecuador'~'44879362'~'TROPICALAGRO S.A.'~'0992228652001'~'SMLU - Seaboard Marine Ltd'~'CHIQUITA FRESH NORTH AMERICA LLC'~'GUAYAQUIL'~'PHILADELPHIA'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'BANANO'~'960'~'PAQUETES'~'19272.96'~'BANANAS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011861'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EXP GROUP LLC'~''~''~''~''~''~'United States'~'38572811'~'SEABOARD MARINE'~'GUAYAS'~''~''~''~''~'Ecuador'~'45211865'~'TRUISFRUIT S.A.'~'0992601523001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'BANANO'~'1080'~'PAQUETES'~'21816'~'CARTONS OF FRESH ECUADORIAN BANANAS TYPE 22XU NET WEIGHT 2032992 KGS DOCUMENTO INTERNO  000030121 TERMOGRAFO ED1BM045S0 DAE  02820184000011721'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011871'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'GOYA FOODS INC'~'CA'~''~''~''~''~'United States'~'27824603'~'SEABOARD MARINE'~'ECGYE'~''~''~'Manabi'~''~'Ecuador'~'44386203'~'GONDI S.A.'~'1390040519001'~'SMLU - Seaboard Marine Ltd'~'EXPORT IMPORT SERVICES INC'~'GUAYAQUIL'~'NEWARK'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'SARDINA EN CONSERVA'~'1650'~'PAQUETES'~'21037.5'~'CARTONS OF SARDINES 1600 CARTONS SARDINES IN TOMATO SAUCE OVAL 15 OZ 425 GR GOYA CAN DIMENSIONS 607X406X107 NET WEIGHT 1632000 KG GROSS WEIGHT 2040000 KG SID 20110124001 50 CARTONS SARDINES IN VEGETABLE OIL OVAL 15 OZ 425 GR GOYA CAN DIMENSIONS 607X406X10'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011881'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EL SOL BRANDS INC'~''~'99 Seaview Boulevard'~'Port Washington'~'New York'~'11050'~'United States'~'27849313'~'SEABOARD MARINE'~'GUAYAS'~''~'Guayas'~'Guayas'~''~'Ecuador'~'41725359'~'TRANSLATIN S.A.'~'0992387920001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1080'~'PAQUETES'~'24493.99'~'PLANTAINS BARRAGANETE'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011891'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EXP GROUP LLC'~''~''~''~''~''~'United States'~'38572811'~'SEABOARD MARINE'~'GUAYAS'~''~'Guayas'~'Guayas'~''~'Ecuador'~'39993455'~'IRISCORP S.A.'~'0992289252001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1080'~'PAQUETES'~'25474.18'~'FRESH PLANTAINS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011901'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'EXPLORA INC'~''~''~'Miami'~'Florida'~'33283'~'United States'~'33483328'~'SEABOARD MARINE'~'GUAYAQUIL'~''~''~'El Oro'~''~'Ecuador'~'28294433'~'AGRORGANICA S A'~'0790150074001'~'SMLU - Seaboard Marine Ltd'~'J&K FRESH EAST'~'GUAYAQUIL'~'PHILADELPHIA'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'BANANO'~'936'~'PAQUETES'~'18720'~'BANANO'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011911'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'GMC IMPORTS CORPORATION'~'ABERDEEN, SC'~''~''~''~''~'United States'~'45209389'~'SEABOARD MARINE'~'GUAYAQUIL'~''~'Guayas'~'Guayas'~''~'Ecuador'~'44294689'~'CEVALLCON S.A.'~'0992507330001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1200'~'PAQUETES'~'24300'~'FRESH PLANTAINS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011921'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'MENDEZ INTERNATIONAL TROPICAL FOOD'~'NY'~''~''~''~''~'United States'~'45919803'~'SEABOARD MARINE'~'GUAYAQUIL'~''~'Guayas'~'Guayas'~''~'Ecuador'~'44242665'~'FRUTINEXUS S.A.'~'0992595159001'~'SMLU - Seaboard Marine Ltd'~'KAMINO AIR IMPORT CORP.'~'GUAYAQUIL'~'BROOKLYN'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'1080'~'PAQUETES'~'25036'~'FRESH PLANTAINS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#1011931'~'CEC2018SMLU0006'~'2018-01-12 00:00:00'~'CHIQUITA FRESH NORTH AMERICA LLC'~'30 AV AND HIGHWAY 90 GULFPORT MS 39501'~''~''~''~''~'United States'~'27824297'~'SEABOARD MARINE'~'GUAYAQUIL'~''~''~''~''~'Ecuador'~'28457849'~'AGROCARIBE S A'~'0791738644001'~'SMLU - Seaboard Marine Ltd'~'CHIQUITA FRESH NORTH AMERICA LLC'~'GUAYAQUIL'~'PHILADELPHIA'~'United States'~'UNITED STATES OF AMERICA'~''~''~''~''~''~''~'WARNOW DOLPHIN'~'Cyprus'~'CY'~'PLATANO'~'2200'~'PAQUETES'~'17204'~'PLATANOS'~'0'~'1'~''~'CITIKOLD S.A.'~'2018-03-20 00:00:00#@#@#"

        file = open(output_file, "w", encoding='utf-8')
        for rec in range(0, rows):
            # sampleData= sampleData.encode('UTF-8')
            file.write(sample_data)
        file.close()
        print("--- %s seconds ---" % (time.time() - start_time))
        print('---------- Complete: create_dummy_file ----------------')
        return True
    except:
        print_exception(create_dummy_file)
        raise


def read_in_chunks(file_object, chunk_size=18000):
    """Lazy function to read the file."""
    while True:
        data = file_object.read(chunk_size)
        if not data:
            break
        yield data


def massage_data(input_file, output_file, rec_sep, line_sep, chunk_size):
    '''
    Massge data is replacement utility function
    pass in custom record, line delimiter and input file
    the function will create file with standard rec(,) and line
    delimiter (newline)
    :param input_file: input file on which replacement needs to be applied
    :param output_file: output file post replacement
    :param rec_sep: column delimiter
    :param line_sep: line delimiter
    :param chunk_size: Size of file in kbs to read at one time
    :return: Boolean
    '''
    try:
        print('---------- Start: massage_data ----------------')
        start_time = time.time()
        # output_file = './/processed//' + os.path.basename(input_file)
        file = open(output_file, "w")

        with open(input_file) as f:
            for rec in read_in_chunks(f, chunk_size):
                rec = re.sub(rec_sep, ',', rec.replace(line_sep, '\n'))
                file.write(rec)

        file.close()

        print("--- %s seconds ---" % (time.time() - start_time))
        print('---------- Complete: massage_data ----------------')
        return True
    except:
        print_exception(massage_data)
        raise


